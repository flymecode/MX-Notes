[TOC]



## 操作系统

### 基本特征

#### 1.并发

在多道程序环境下，并发是指一段时间内宏观上有多个程序在同时运行，在微观上这些程序是分时交替的执行，而并行则是指同一时刻有两个或多个程序在执行。

并行需要硬件的支持，如多处理器。



#### 2.共享

共享是指操作系统中的资源可以提供给内存中多个并发的执行进程共同使用。

两种共享的方式：

- 互斥共享
- 同时访问

互斥共享的资源被称为临界资源，比如打印机，在同一段时间内只允许一个进程访问的资源，称为临界资源。

#### 3.虚拟

虚拟就是把一个物理实体变成若干逻辑上的对应物。

前者是实际存在的，而后者是虚的，只是用户感觉上存在而已。

主要的两种虚拟技术: 时分复用和空分复用技术。

时分复用：是指在利用某设备为一用户服务的空闲时间内，又转去为其他用户服务，使设备得到充分的利用。

空分复用：是指利用存储器的空闲分区域存放和运行其它的多道程序，来提高内存的利用率。  



#### 4.异步

异步是指进程不是一次执行完毕，而是走走停停，以不可知的速度向前推进。

### 进程管理

#### 1.进程

进程是指系统中能独立运行并作为资源分配的基本单位。

进程控制块（Process Control Block,PCB）描述进程的基本信息和运行状态，所谓创建进程和撤销进程都是对PCB进行操作。



#### 2.线程

线程是独立调度的基本单位。

一个进程中可以有多个线程，他们共享进程的资源。

### 3.进程和线程的区别

1.拥有资源

进程是资源分配的基本单位，但是线程不拥有资源，线程可以访问隶属于进程的资源。

2.调度

线程是独立调度的基本单位，在同一进程中，线程的切换不会引起进程切换，从一个进程中的线程切换到另一个进程中的线程会引起进程的切换。

3.系统开销

由于创建和撤销进程，系统都要为之分配和回收资源，如内存空间，I/O设备等，所付出的开销远大于创建或撤销线程时的开销。类似地，在进行进程切换时，涉及当前执行进程CPU环境的保存以及新调度进程CPU环境的设置。而进程切换时只需要保存和设置少量寄存器的内容，开销很小。

4.通信

线程间可以通过直接读写同一进程的数据进通信，但是进程的通信需要借助IPC



#### 进程的特征

- 动态性
- 并发性
- 独立性
- 异步性

### 进程状态的切换

- 就绪状态 ：等待被调度
- 运行状态
- 阻塞状态 ： 等待资源

注意一下内容：

- 只有就绪状态和运行状态可以相互切换，其它都是单向的转换，就绪状态的进程通过调度算法从而获得CPU时间，转为运行状态；而运行状态的进程，在分配给它的CPU时间片用完之后就会转为就绪状态，等待下一次调度。
- 阻塞状态是缺少需要的资源从而由运行状态转换而来，但是该资源不包括CPU时间，缺少CPU时间会从运行状态转为就绪状态。

### 进程的调度算法

不同环境的调度算法目标不同，因此需要针对不同的环境来讨论调度算法。

### 1.批处理系统

批处理系统没有天多的用户操作，在该系统中，调度算法目标是保证系统的吞吐量和周转时间（从提交到终止的时间）。

##### 先来先服务

按照请求的顺序进行调度。

有利于长作业，但是不利于短作业，因为短作业必须一直等待前面长作业执行完毕之后才能执行，而长作业又需要执行很长的时间，造成了短作业等待时间过长。

##### 短作业优先

##### 最短剩余时间优先

##### 时间片轮转

##### 优先级调度

##### 多级反馈队列

### 程序并发执行的特征

- 间断性 
- 失去封闭性
- 不可再现性



## 大内核与微内核

### 1.大内核

大内核是将操作系统功能作为一个紧密结合的整体放到内核。

由于各模块共享信息，因此有很高的性能。



#### 2.微内核

随着操作系统的不断复杂，因此将一部分操作系统的功能移除内核，从而降低内核的复杂性。移出的部分根据分成的原则划分成若干服务。相互独立。

在微内核结构下，操作系统划分成小的，定义良好的模块，只有微内核这一个模块运行在内核态，其余模块运行在用户太。

因为需要频繁的在用户态和核心态之间进行切换，所以有一定的性能上的损失。



## 进程同步

### 临界区

### 同步和互斥

- 同步：多个进程按照一定的顺序执行
- 互斥：多个进程在同一时刻只有一个进程能进入临界区

### 信号量

信号量是一个整型变量，可以对其执行down和up操作，也就是常见的P和V操作。

- down：如果信号量大于0，执行-1操作；如果信号量等于0,进程睡眠，等待信号量大于0.
- up:对信号量执行+1操作，唤醒睡眠的进程让其完成down操作。

down和up操作需要被设计成原语，不可分割



### 中断分类

#### 1.外中断

由CPU执行指令以外的事件引起，如 I/O 完成中断，表示设备输入/输出处理已经完成，处理器能够发送下一个输入/输出请求。此外还有时钟中断、控制台中断等。

#### 2.异常

由CPU执行指令内部事件引起，如非法操作码，地址越界，算术溢出等。

#### 3.陷入

在用户程序中使用系统调用。

